
# üìÑ DRVAUDIO.md ‚Äî –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –∞—É–¥–∏–æ

## üß© –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é **–∞—É–¥–∏–æ-–¥—Ä–∞–π–≤–µ—Ä–∞** (`drv-mic-*`) –≤ —Ä–∞–º–∫–∞—Ö —Å–∏—Å—Ç–µ–º—ã AI Agent, –≤–∫–ª—é—á–∞—è:
- –µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ,
- —Ñ–æ—Ä–º–∞—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –∞—É–¥–∏–æ –≤ `svc-audio-in`,
- –º–µ—Ä—ã –ø–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—é –ø–æ—Ç–µ—Ä–∏ –∞—É–¥–∏–æ –º–µ–∂–¥—É —á–∞–Ω–∫–∞–º–∏.

---

## üéØ –¶–µ–ª—å

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–π, —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π –∏ –ª–µ–≥–∫–æ –æ—Ç–ª–∞–∂–∏–≤–∞–µ–º—ã–π –º–µ—Ö–∞–Ω–∏–∑–º **–ø–æ—Ç–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –∞—É–¥–∏–æ –æ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞ –∫ —Å–µ—Ä–≤–∏—Å—É**, —Å–ø–æ—Å–æ–±–Ω—ã–π —Ä–∞–±–æ—Ç–∞—Ç—å:
- —Å **–ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞–º–∏** (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π, USB, Bluetooth),
- –Ω–∞ **—Ä–∞–∑–Ω—ã—Ö —Ö–æ—Å—Ç–∞—Ö** (–Ω–∞–ø—Ä–∏–º–µ—Ä, Raspberry Pi –∏ MacBook),
- –≤ **—Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö** (VAD, –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π, –¥–∏–∫—Ç–æ–≤–∫–∞).

---

## ‚öôÔ∏è –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       HTTP POST       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚Üí STT / Hotword
‚îÇ drv-mic-*  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  svc-audio-in   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ –æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  WAV + JSON metadata  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

- `drv-mic-*`: –¥—Ä–∞–π–≤–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞.
- `svc-audio-in`: —Å–µ—Ä–≤–∏—Å, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π —á–∞–Ω–∫–∏, —Ñ–∏–ª—å—Ç—Ä—É—é—â–∏–π, –∏—â—É—â–∏–π hotword, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π –≤ –∫–æ–º–∞–Ω–¥—ã.

---

## üì• –í—Ö–æ–¥ –¥—Ä–∞–π–≤–µ—Ä–∞

- –ê—É–¥–∏–æ —Å –æ–¥–Ω–æ–≥–æ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞** (`hw:<device>`)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
  - `DEVICE_NAME` ‚Äî –∏–º—è ALSA-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `plughw:1,0`)
  - `CHUNK_DURATION` ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–∞–Ω–∫–∞ (—Å–µ–∫), –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2—Å
  - `OVERLAP_DURATION` ‚Äî –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –º–µ–∂–¥—É —á–∞–Ω–∫–∞–º–∏ (–º—Å), –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 500–º—Å
  - `TARGET_URL` ‚Äî URL `svc-audio-in`

---

## üì§ –í—ã—Ö–æ–¥ –¥—Ä–∞–π–≤–µ—Ä–∞

- –ö–∞–∂–¥—ã–µ `CHUNK_DURATION` —Å–µ–∫—É–Ω–¥:
  - —Å–æ–∑–¥–∞—ë—Ç—Å—è `.wav` —Ñ–∞–π–ª (16kHz, mono)
  - –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è **–ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ** —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —á–∞–Ω–∫–æ–º –Ω–∞ `OVERLAP_DURATION`
  - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `HTTP POST`:
    ```
    POST {TARGET_URL}/ingest
    Content-Type: multipart/form-data

    {
      "file": <WAV>,
      "metadata": {
        "device_id": "frai-001",
        "isFrai": true,
        "timestamp": 1682030912
      }
    }
    ```

---

## üö´ –ü—Ä–æ–±–ª–µ–º–∞ –ø–æ—Ç–µ—Ä–∏ –∞—É–¥–∏–æ

–ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç –æ–¥–Ω–æ–≥–æ —á–∞–Ω–∫–∞ –∫ –¥—Ä—É–≥–æ–º—É –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å **–ø–æ—Ç–µ—Ä—é –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ñ—Ä–µ–π–º–æ–≤**, –æ—Å–æ–±–µ–Ω–Ω–æ:
- –µ—Å–ª–∏ –∑–∞–ø–∏—Å—å –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–Ω–∏–º–∞—é—Ç –≤—Ä–µ–º—è,
- –∏–ª–∏ –µ—Å–ª–∏ VAD –≤–∫–ª—é—á—ë–Ω.

### üí° –†–µ—à–µ–Ω–∏–µ:
- –ö–∞–∂–¥–æ–º—É —á–∞–Ω–∫—É –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è **–ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º** –Ω–∞ `OVERLAP_DURATION`
- –ü—Ä–∏–º–µ—Ä: –µ—Å–ª–∏ `CHUNK_DURATION = 2.0`, `OVERLAP_DURATION = 0.5`, —Ç–æ:
  - `chunk_001`: [0.0s ‚Äî 2.0s]
  - `chunk_002`: [1.5s ‚Äî 3.5s]
  - –∏ —Ç.–¥.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ **—Å–ª–æ–≤–∞ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –Ω–∞ —Å—Ç—ã–∫–µ**
- —Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç **–æ–±—ä–µ–¥–∏–Ω—è—Ç—å —á–∞–Ω–∫–∏ —Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏** –ø–æ VAD/—Å–ª–æ–≤–∞—Ä—é

---

## üîÅ –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

- **–û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º**: –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å —á–∞–Ω–∫–æ–≤
- **VAD-—Ä–µ–∂–∏–º**: –∑–∞–ø–∏—Å—å –≤–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–∏ –≥–æ–ª–æ—Å–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **–î–∏–∫—Ç–æ–≤–∫–∞**: —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º, –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ñ–ª–∞–≥–æ–º, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—É—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ –∏ —Å–Ω–∏–∂–∞–µ—Ç VAD-—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## üß™ –ü—Ä–∏–º–µ—Ä curl-–∑–∞–ø—Ä–æ—Å–∞

```bash
curl -X POST http://svc-audio-in:5231/ingest \
  -F "file=@chunk.wav" \
  -F 'metadata={
    "device_id": "dev-001",
    "isFrai": false,
    "timestamp": 1682030912
  }'
```

---

## üìé –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- `drv-mic-*` –ù–ï –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç hotword ‚Äî —ç—Ç–æ –¥–µ–ª–∞–µ—Ç `svc-audio-in`
- –ö–∞–∂–¥—ã–π –¥—Ä–∞–π–≤–µ—Ä –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –¥–ª—è –æ–¥–Ω–æ–≥–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å: 1 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä = 1 –º–∏–∫—Ä–æ—Ñ–æ–Ω

---

# üéôÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–≤: –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

## üß© 1. –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã (OS / –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

| –û–° / Arch                      | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—É–¥–∏–æ | –î—Ä–∞–π–≤–µ—Ä—ã / API                                | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                                    |
|-------------------------------|------------------|------------------------------------------------|------------------------------------------------|
| **Raspberry Pi OS (arm64)**   | ‚úÖ ALSA           | `alsa-utils`, `arecord`, `pyalsaaudio`         | –ß–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –∑–∞–¥–∞–≤–∞—Ç—å device index      |
| **Kali Linux (x86_64)**       | ‚úÖ ALSA, Pulse    | `arecord`, `pulseaudio`, `pipewire`            | –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `pyaudio` –∏–ª–∏ `ffmpeg`      |
| **Kali Linux (aarch64, M1)**  | ‚úÖ ALSA (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ) | `pyalsaaudio`, `arecord` (—á–∞—Å—Ç–æ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ) | –ò–Ω–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä—É—á–Ω—É—é             |
| **macOS (M1)**                | ‚úÖ CoreAudio      | `pyaudio`, `sounddevice`, `ffmpeg`             | –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è + sandboxing |
| **Windows 11 (x86_64)**       | ‚úÖ WASAPI, MME    | `pyaudio`, `sounddevice`, `ffmpeg`             | –ß–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å Input Device –ø–æ ID         |

## üîå 2. –¢–∏–ø—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞

| –¢–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è  | –ü–æ–¥–¥–µ—Ä–∂–∫–∞  | –ó–∞–º–µ—á–∞–Ω–∏—è                                                              |
|------------------|------------|-------------------------------------------------------------------------|
| **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π (built-in)** | ‚úÖ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ default input device                       |
| **Mic-In / Analog**       | ‚úÖ | –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –∑–≤—É–∫–æ–≤–∞—è –∫–∞—Ä—Ç–∞ (`card0`, `card1`, ...)               |
| **USB**                   | ‚úÖ | –õ–µ–≥–∫–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ ALSA (`USB Audio Device`)                    |
| **Bluetooth (HFP/HSP)**   | ‚ö†Ô∏è | –¢—Ä–µ–±—É–µ—Ç pulseaudio –∏–ª–∏ pipewire —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø—Ä–æ—Ñ–∏–ª—è                  |
| **Internet (UDP/WebRTC)**| ‚ö†Ô∏è | –¢—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ (WebRTC, RTP, SIP)                         |

## üì± 3. –ú–æ–±–∏–ª—å–Ω—ã–µ –∏ –Ω–æ—Å–∏–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

| –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ     | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞—É–¥–∏–æ–ø–æ—Ç–æ–∫–∞ | –ü—Ä–æ—Ç–æ–∫–æ–ª—ã / API             | –ó–∞–º–µ—á–∞–Ω–∏—è                                             |
|----------------|--------------------------|------------------------------|--------------------------------------------------------|
| **iPhone / iPad**   | ‚úÖ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ     | `AVFoundation`, WebRTC        | –ù—É–∂–Ω–æ –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ webRTC-—Å—Ç—Ä–∞–Ω–∏—Ü–∞         |
| **Android**         | ‚úÖ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ     | `AudioRecord`, WebRTC         | –ú–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –Ω–∞ WebSocket/HTTP —Å–µ—Ä–≤–µ—Ä   |
| **Apple Watch**     | ‚ö†Ô∏è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ           | `WatchKit`, BLE (—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏) | –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã, –Ω–µ –ø–æ—Ç–æ–∫           |

## üí° –í—ã–≤–æ–¥—ã

- –î–ª—è **—Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö –∏ SBC** —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (Pi, Kali, Windows) ‚Äî –∏–¥–µ–∞–ª–µ–Ω ALSA/PyAudio/ffmpeg —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º input device.
- –î–ª—è **macOS** –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sounddevice` –∏–ª–∏ `pyaudio`, –Ω–æ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É.
- –î–ª—è **–º–æ–±–∏–ª—å–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º** –Ω—É–∂–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ø–æ WebSocket –∏–ª–∏ HTTP.
- **Bluetooth –∏ —Å–µ—Ç–µ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞** —Ç—Ä–µ–±—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–¥–µ–º–æ–Ω—ã, –∫–ª–∏–µ–Ω—Ç—ã).

